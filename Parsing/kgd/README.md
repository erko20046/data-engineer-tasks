
# Taxpayer Microservice

## Описание

Микросервис предназначен для получения и обработки данных о налогоплательщиках Казахстана через gRPC API. Сервис интегрируется с внешним источником данных, решает капчу, парсит и маппит данные в protobuf-структуры.

## Технологии

- Python
- gRPC (asyncio)
- Protobuf
- ScrapyX (для HTTP-запросов и капчи)
- Логирование через стандартный `logging`

## Архитектура

- **main.py** — запуск gRPC-сервера, регистрация сервисов и рефлексии.
- **services/** — gRPC-сервисы, реализующие бизнес-логику.
- **parsers/** — парсеры для получения и нормализации данных из внешнего API.
- **mappers/** — преобразование данных в protobuf-структуры.
- **protos/** — protobuf-описания сообщений и сервисов.

## Как работает

1. Клиент отправляет gRPC-запрос с ИИН/БИН или именем и типом налогоплательщика.
2. Сервис решает капчу, делает HTTP-запрос к внешнему API.
3. Парсер обрабатывает и нормализует ответ.
4. Маппер преобразует данные в protobuf-структуры.
5. Ответ возвращается клиенту через gRPC.

## Запуск

1. Установите зависимости:  
   ```
   pip install -r requirements.txt
   ```
2. Запустите сервер:  
   ```
   python main.py
   ```
3. gRPC-сервер будет доступен на порту, указанном в `settings/configurations.port`.

## Протокол

Сервис реализует gRPC-интерфейс `TaxpayerScraper` с методом `LoadData`.  
Описание сообщений и сервисов — в файле `protos/kgdtaxpayer.proto`.

## Логирование

Все запросы и ошибки логируются с дополнительной информацией для аудита и отладки.

---

Файл можно сохранить как `README.md` в корне проекта.
